<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Googleカレンダー予定リンク生成ツール</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2em;
      max-width: 600px;
      margin: auto;
    }
    input, textarea {
      width: 100%;
      margin-bottom: 1em;
      padding: 0.5em;
      font-size: 1em;
    }
    label {
      font-weight: bold;
    }
    #output {
      margin-top: 1em;
      padding: 1em;
      background: #f5f5f5;
      border-radius: 5px;
      word-break: break-all;
    }
    button.copy-btn {
      margin-top: 0.5em;
      padding: 0.5em 1em;
      background-color: #34A853;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button.copy-btn:hover {
      background-color: #2c8a45;
    }
  </style>
</head>
<body>
  <h1>Googleカレンダー予定リンク生成ツール</h1>
  <form id="calendarForm">
    <label for="title">イベント名:</label>
    <input type="text" id="title" required>

    <label for="start">開始日時:</label>
    <input type="datetime-local" id="start" required>

    <label for="end">終了日時:</label>
    <input type="datetime-local" id="end" required>

    <label for="details">詳細:</label>
    <textarea id="details" rows="3"></textarea>

    <label for="location">場所:</label>
    <input type="text" id="location">

    <button type="submit">リンク生成</button>
  </form>

  <div id="output" style="display:none;">
    <p><strong>生成されたリンク:</strong></p>
    <input type="text" id="calendarLink" readonly>
    <button class="copy-btn" onclick="copyLink()">URLをコピー</button>
  </div>

  <script>
    document.getElementById('calendarForm').addEventListener('submit', function (e) {
      e.preventDefault();

      function formatDate(dateStr) {
        const d = new Date(dateStr);
        const pad = n => n.toString().padStart(2, '0');
        return d.getFullYear() +
          pad(d.getMonth() + 1) +
          pad(d.getDate()) + 'T' +
          pad(d.getHours()) +
          pad(d.getMinutes()) +
          '00';
      }

      const title = encodeURIComponent(document.getElementById('title').value);
      const start = formatDate(document.getElementById('start').value);
      const end = formatDate(document.getElementById('end').value);
      const details = encodeURIComponent(document.getElementById('details').value);
      const location = encodeURIComponent(document.getElementById('location').value);

      const baseUrl = 'https://calendar.google.com/calendar/render?action=TEMPLATE';
      const url = `${baseUrl}&text=${title}&dates=${start}/${end}&details=${details}&location=${location}`;

      const linkInput = document.getElementById('calendarLink');
      linkInput.value = url;
      document.getElementById('output').style.display = 'block';
    });

    function copyLink() {
      const linkInput = document.getElementById('calendarLink');
      linkInput.select();
      linkInput.setSelectionRange(0, 99999); // モバイル対応
      document.execCommand('copy');
      alert("URLをコピーしました！");
    }
  </script>
</body>
</html>
